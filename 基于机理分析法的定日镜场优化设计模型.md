
## 摘要
本文针对定日镜场优化设计问题，运用光学相关定律进行机理分析，建立单目标最优化模型，基于三分查找、蒙特卡洛方法进行计算机求解，在不同的定日镜数量、位置、尺寸的多种情形下，解决了定日镜场各效率的求解与输出功率优化问题。  

对于给定镜场参数情形下的光学效率与输出热功率求解问题，将定日镜反射集热过程划分为太阳光线入射过程、定日镜法向调整过程、阴影遮挡与集热器截断过程，分别进行建模。太阳光线入射过程，通过太阳高度角、方位角确定入射光线方向；定日镜法向调整过程，通过太阳高度角、方位角确定入射光线方向，通过定日镜法向调整过程，根据定日镜与集热器中心位置计算反射光线方向向量，从而计算出各定日镜平面法向量；阴影遮挡与集热器截断过程，利用空间向量方法判断光线入射、反射过程中是否被其他定日镜阻挡，计算镜面各点反射锥形光线在集热器表面形成的光斑面积，从而计算阴影遮挡效率、集热器截断效率。通过上述分析，建立定日镜场光学效率与输出热功率求解模型。将定日镜面栅格化，求解得到在原问题给定参数下，定日镜场光学效率、余弦效率、阴影遮挡效率、截断效率、输出热功率、单位面积镜面输出热功率的年平均值分别为0.4902，0.7565，0.8955，0.8078，24.04MW，0.3827kW/m²。  

对于统一定日镜尺寸及安装高度情形下镜场单位面积镜面输出热功率（以下简称年平均功率）的优化问题，可利用上一问题模型计算年平均功率并进行优化。以最大化年平均功率为优化目标，镜场半径、定日镜与吸收塔距离、镜面宽高、相邻定日镜底座中心距离的限制为约束条件，建立镜场年平均功率单目标优化模型。为降低庞大的解空间维度，固定其他变量，对镜面宽、高等变量单独分析，基于三分查找算法搜索变量的较优解，得到近似最优情形下，吸收塔的平面位置坐标为(0,-237.0240)，定日镜宽、高均为5.4670m，安装高度均为6m，定日镜数量为3249，镜场光学效率、余弦效率、阴影遮挡效率、截断效率、输出热功率、单位面积镜面输出热功率的年平均值分别为0.5787，0.8614，0.8546，0.8811，43.73MW，0.4505kW/m²。  

对于各定日镜尺寸及安装高度可变情形下镜场年平均功率的优化问题，本问题仅在上一问题基础上增大了解空间维度，故建立优化目标、约束条件与上一问题相同的镜场年平均功率单目标优化模型。以各排定日镜安装高度为决策变量进行蒙特卡洛模拟求解，其他参数与上一问题保持一致，得到近似最优情形下，镜场光学效率、余弦效率、阴影遮挡效率、截断效率、输出热功率、单位面积镜面输出热功率的年平均值分别为0.5856，0.8625，0.8642，0.8804，44.25MW，0.4556kW/m²，定日镜数量、各定日镜尺寸与安装高度、吸收塔位置坐标与上一问题一致。  

最后，对模型进行检验，并评估模型优缺点。  

**关键词：** 定日镜场 单目标优化 栅格化 三分查找 蒙特卡洛  


# 一、问题重述
## 1.1 问题背景  
我国正积极采取行动，以应对气候变化并实现“碳达峰”和“碳中和”的目标，为达到该目标，需构建一个以新能源为主体的电力系统。因此，我国计划在地理坐标为东经98.5度和北纬39.4度，位于海拔3000米的高海拔地区上实施太阳能发电项目。  

此发电项目利用了塔式太阳能光热发电技术，它是一种低碳、环保的清洁能源技术。在这个技术中，定日镜是基本组件之一。定日镜由两个主要部分组成：纵向转轴和水平转轴，平面反射镜则安装在水平转轴上。纵向转轴的轴线与地面垂直，负责控制反射镜的方位角，而水平转轴的轴线与地面平行，用于控制反射镜的俯仰角。这些调整可以确保太阳光线准确地聚焦在吸收塔上的集热器上。  

为实现发电目标，计划在圆形区域内建设一个定日镜场，这个区域的半径为350米。为了便于规划和操作，以圆形区域的中心为原点，建立三维坐标系。项目规划中，吸收塔的高度为80米，集热器采用高8米、直径7米的圆柱形外表受光式集热器。此外，规划还包括在吸收塔周围的100米范围内留出空地，以用于建造厂房。  

定日镜的形状为平面矩形，其中上下两条边始终平行于地面。且上下两条边之间的距离和左右两条边之间的距离被分别定义为镜面高度与宽度。为确保稳定的反射效果，镜面宽度不小于镜面高度。此外，为了维护和清洗设备，相邻定日镜底座中心之间的距离必须比镜面宽度多出至少5米。  

最后，为了进行性能评估和数据分析，所有“年均”指标的计算时点均为当地时间每月21日的几个具体时刻，包括9:00、10:30、12:00、13:30和15:00。  


## 1.2 问题要求  
**问题一**：在本问题中，需要在以吸收塔为圆心，半径为350m的圆形区域内建设一个圆形定日镜场。在已知定日镜的尺寸以及各个定日镜的地理位置情况下，该问题的目标是计算该定日镜场的年均光学效率，年均输出热功率，和单位镜面积的年均输出热功率。光学效率和输出热功率的定义已在附录中给出，最终的计算结果将以表格1和表格2的格式进行呈现。  

**问题二**：本问题需要在满足定日镜场的额定年平均输出热功率为60 MW的前提下，最大化单位镜面面积年平均输出热功率。为此，需要确定吸收塔的位置坐标、定日镜尺寸、安装高度、定日镜数目以及定日镜位置。在设计过程中，各个定日镜尺寸以及安装高度需保持相同。设计完成后，将结果按照表格1、2、3的格式填写，并将吸收塔的位置坐标、定日镜尺寸、安装高度以及定日镜位置按照指定格式保存到名为”result2.xlsx”的文件中。  

**问题三**：在本问题中，由于定日镜的尺寸以及安装高度可以不同，因此需要重新设计太阳能定日镜场，以满足定日镜场的额定功率为60MW的条件下，最大化单位镜面面积年平均输出热功率。设计完成后，将结果按照表格1、表格2和表格3的格式填写，并将吸收塔的位置坐标、各定日镜尺寸、安装高度以及定日镜位置按照指定格式保存到名为”result3.xlsx”的文件中。  


# 二、问题分析  
## 2.1 对定日镜场光学效率与输出热功率求解模型的分析  
在本问题中，需根据原问题给定参数计算定日镜场的月平均与年平均余弦效率、阴影遮挡效率、光学效率等指标。为计算余弦效率和阴影遮挡效率，首先需要确定太阳方位、定日镜平面法向量，可栅格化定日镜平面，对每一栅格判断光线是否被遮挡或形成阴影。对反射无遮挡的光线，可模拟镜面反射时形成的锥形光束，通过集热器表面光斑面积求解集热器截断效率。镜面反射率可取为固定常数，大气透射率可通过镜面中心到集热器距离进行求解。通过上述效率值，进一步计算镜场光学效率、输出热功率等。  


## 2.2 对镜场年平均功率优化模型的分析  
在本问题中，需要在统一定日镜尺寸及安装高度情形下，对单位镜面面积年平均输出的热功率进行优化，需要基于上一问题模型计算定日镜场各效率值，利用单目标优化相关理论进行求解。由于各定日镜的位置、安装高度均为决策变量，解空间维数庞大，需要先进行降维处理，减少决策变量个数，可以利用固定若干变量、搜索其他变量较优解的方法对解空间进行降维。  


## 2.3 对镜场年平均功率优化模型的分析  
在本问题中，需要在各定日镜尺寸及安装高度可自由选择的情形下，对单位镜面面积年平均输出的热功率进行优化。与上一问题类似，可利用单目标最优化理论进行求解。本问题各个定日镜的高度、宽度与底座中心位置坐标均为决策变量，解空间维数相比上一问题进一步增大，需要在上一问题的定日镜位置坐标基础上进行调整，可以利用蒙特卡洛方法进行随机模拟，求解近似最优解。  



# 三、模型假设与约定
1. 忽略降雨等天气因素对定日镜光学效率的影响，仅考虑晴朗天气的情形；  
2. 反射光线在集热器表面形成的光斑内均匀分布，且能量全部被集热器接收；  
3. 计算阴影遮挡、余弦效率时，由于太阳光锥顶角极小，将入射太阳光视为平行光；  
4. 计算某块定日镜阴影遮挡时，仅考虑其他定日镜对入射、反射太阳光的遮挡，忽略吸收塔导致的阴影遮挡；  
5. 忽略镜面厚度；  
6. 不考虑镜场内地形起伏；  
7. 所有镜面上各点镜面反射率均为相等的常数；  
8. 忽略光线在定日镜表面的漫反射。  




# 四、符号说明及名词定义
## 表1 符号说明
| 符号       | 含义                                      | 单位 |
| ---------- | ----------------------------------------- | ---- |
|$\delta$  | 太阳赤纬角                                | rad  |
|$\omega$  | 太阳时角                                  | rad  |
|$\phi$    | 定日镜场所在地纬度，北纬为正              | rad  |
|$H_a$     | 定日镜场所在地海拔                        | km   |
|$\alpha_s$| 太阳高度角                                | rad  |
|$\gamma_s$| 太阳方位角                                | rad  |
|$u_i$     | 第$i$块定日镜中心入射光线方向向量          | -    |
|$v_i$     | 第$i$块定日镜中心反射光线方向向量          | -    |
|$n_i$     | 第$i$块定日镜平面法向量                    | -    |
|$\eta_i$  | 第$i$块定日镜光学效率                      | -    |
|$(\eta_{\text{cos}})_i$| 第$i$块定日镜余弦效率              | -    |
|$(\eta_{\text{sh}})_i$ | 第$i$块定日镜阴影遮挡效率          | -    |
|$(\eta_{\text{trunc}})_i$| 第$i$块定日镜对应集热器截断效率  | -    |
|$A_i$     | 第$i$块定日镜采光面积                      |$\text{m}^2$|
|$W_i$     | 第$i$块定日镜宽度                          | m    |
|$H_i$     | 第$i$块定日镜高度                          | m    |
|$h_i$     | 第$i$块定日镜安装高度                      | m    |
|$N$       | 定日镜场定日镜总面数                      | -    |
|$x_c$     | 集热器中心在镜场坐标系内$x$坐标            | m    |
|$y_c$     | 集热器中心在镜场坐标系内$y$坐标            | m    |
|$z_c$     | 集热器中心在镜场坐标系内$z$坐标            | m    |
|$E_{field}$| 定日镜场输出热功率                        |$\text{kW/m}^2$| 
# 五、模型建立与求解
## 5.1 问题一的模型建立与求解
### 5.1.1 问题一的建模准备  
在本问题中涉及到光线的反射与入射，因此需要判断入射点是否在定日镜面上。  

#### 平面内一点的位置判断  
判断平面上一点$P$是否在矩形内，可将矩形分为两个三角形，因此该问题等价于判断平面上该点是否位于其中任意一三角形内。如图1(b)所示，将一个矩形沿其对角线将其等分为两个三角形，其中$Q_i$为矩形区域，从而将问题转换为判断平面一点是否位于三角形内部。  

![[Fig01.png]]
<div align="center">      
    <p>图 1</p>  
</div>  

若平面上一点在三角形内如图1(a)，其满足如下条件：  
$$
\begin{cases} 
(\vec{AB} \times \vec{AP}) \cdot (\vec{AB} \times \vec{AC}) > 0 \\
(\vec{BC} \times \vec{BP}) \cdot (\vec{BC} \times \vec{BA}) > 0 \\
(\vec{CA} \times \vec{CP}) \cdot (\vec{CA} \times \vec{CB}) > 0 
\end{cases} \tag{1}
$$ 


### 5.1.2 问题一的模型建立  
在本问题中需要对定日镜场的年平均光学效率、年平均输出热功率以及单位镜面面积年平均输出热功率。通过题目所给公式以及信息得知，为计算各个定日镜的光学效率和输出热功率，需要确定各时刻太阳方位角、高度角，从而确定各个定日镜平面法向量，并计算阴影遮挡效率、截断效率、余弦效率等相关参数。  


# 太阳方位的确定：
为确定太阳方位，需计算太阳高度角、方位角，为此需要先计算太阳赤纬角、时角。太阳的高度角、方位角、时角、赤纬角如下图所示：  
![[Pasted image 20250629100129.png]]
<div align="center">      
    <p>图 2</p>  
</div>  

太阳赤纬角$\delta$表征了给定时刻日地连线与地球赤道面之间的夹角$^{[1]}$，其计算公式如下：  
$$
\sin \delta = \sin \frac{2\pi D}{365} \sin \left( \frac{2\pi}{360} 23.45 \right) \tag{2}
$$ 
其中$D$为以春分作为第 0 天起算的天数。  


太阳时角$\omega$是由于地球自转引起太阳相对地球转动的角度，等于地球在一段时间内自转角度$^{[1]}$，其计算公式如下：  
$$
\omega = \frac{\pi}{12} (ST - 12) \tag{3}
$$ 
其中$ST$为当地时间。  


根据太阳赤纬角、时角，可以计算太阳高度角与太阳方位角。  

太阳高度角$\alpha_s$是太阳入射光线与地平面之间的夹角$^{[1]}$，计算公式如下：  
$$
\sin \alpha_s = \cos \delta \cos \varphi \cos \omega + \sin \delta \sin \varphi \tag{4}
$$ 
其中$\delta$为太阳赤纬角，$\varphi$为当地纬度 (北纬为正),$\omega$为太阳时角。  


太阳方位角$\gamma_s$是入射光线在地平面上的垂直投影与镜场坐标系$y$轴之间的夹角，计算公式如下：  
$$
\cos \gamma_s = \frac{\sin \delta - \sin \alpha_s \sin \varphi}{\cos \alpha_s \cos \varphi} \tag{5}
$$ 
其中$\alpha_s$为太阳高度角，$\delta$为太阳赤纬角，$\varphi$为当地纬度 (北纬为正)。  


**定日镜平面法向量的计算：**  

设第$i$块定日镜入射光线单位方向向量为$\boldsymbol{u}_i$，反射光线单位方向向量为$\boldsymbol{v}_i$，且$\boldsymbol{u}_i$、$\boldsymbol{v}_i$方向分别与入射光线、反射光线同向，如图 3 所示：  
![[Pasted image 20250629100748.png]]
<div align="center">
    <p>图 3 各方向向量、法向量、反射角图示</p>  
</div>  


由于入射到定日镜中心的光线需反射到集热器中心，根据第$i$块定日镜中心坐标$(x_i, y_i, z_i)$与集热器中心坐标$(x_c, y_c, z_c)$得到反射光线方向向量为：  
$$
\boldsymbol{t}_i = (x_c - x_i)\boldsymbol{e}_x + (y_c - y_i)\boldsymbol{e}_y + (z_c - z_i)\boldsymbol{e}_z \tag{6}
$$ 
其中$\boldsymbol{e}_x, \boldsymbol{e}_y, \boldsymbol{e}_z$分别为指向$x, y, z$轴正方向的单位向量。  


反射光线所对应的单位向量$\boldsymbol{v}_i$为：  
$$
\boldsymbol{v}_i = \frac{\boldsymbol{e}_x (x_c - x_i) + \boldsymbol{e}_y (y_c - y_i) + \boldsymbol{e}_z (z_c - z_i)}{\sqrt{(x_c - x_i)^2 + (y_c - y_i)^2 + (z_c - z_i)^2}} \tag{7}
$$ 


如图 2 所示，由于入射光线$\boldsymbol{u}_i$和反射光线$\boldsymbol{v}_i$的模长均为 1，根据矢量几何关系可得第$i$块定日镜所在平面法向量$\boldsymbol{n}_i$为：  
$$
\boldsymbol{n}_i = \boldsymbol{v}_i - \boldsymbol{u}_i \tag{8}
$$ 


### 镜面反射率模型  
依据题目信息，镜面反射率$\eta_{\text{ref}}$为常数$0.92$。  


### 阴影遮挡效率模型  
如图 3 所示，$\boldsymbol{u}_i, \boldsymbol{v}_i, \boldsymbol{n}_i$分别为第$i$块定日镜入射光线方向向量，反射光线方向向量，定日镜平面法向量，入射点的坐标为$(x_{r_i}, y_{r_i}, z_{r_i})$。因此入射光线所在直线方程为：  
$$
\frac{x - x_{r_i}}{u_{ix}} = \frac{y - y_{r_i}}{u_{iy}} = \frac{z - z_{r_i}}{u_{iz}} \tag{9}
$$ 

反射光线所在的直线方程为：  
$$
\frac{x - x_{r_i}}{v_{i_x}} = \frac{y - y_{r_i}}{v_{i_y}} = \frac{z - z_{r_i}}{v_{i_z}} \tag{10}
$$ 

定日镜所在平面方程为：  
$$
n_{ix}(x - x_{r_i}) + n_{iy}(y - y_{r_i}) + n_{iz}(z - z_{r_i}) = 0 \tag{11}
$$ 

考虑第$j$块定日镜，其所在的平面方程为：  
$$
n_{jx}(x - x_{r_j}) + n_{jy}(y - y_{r_j}) + n_{jz}(z - z_{r_j}) = 0 \tag{12}
$$ 

联立 9 式和 12 式可求得交点$P_1$为$(x_{i1}, y_{i1}, z_{i1})$，联立 10 式和 12 式可求得交点$P_2$为$(x_{i2}, y_{i2}, z_{i2})$。  


#### 阴影与遮挡判断逻辑  
为判断入射光线是否会形成阴影以及反射光线是否会被遮挡，记第$i$块定日镜镜面矩形区域为$Q_i$。若$(x_{i1}, y_{i1}, z_{i1})$在$Q_i$内，且$(x_{i1}, y_{i1}, z_{i1})$在第$i$块定日镜入射光线一侧，则入射光线到达第$i$块定日前被第$j$块定日镜阻碍，称为阴影。$(x_{i1}, y_{i1}, z_{i1})$在定日镜入射光线一侧，等价于向量$(x_{r_i} - x_{i1})e_x + (y_{r_i} - y_{i1})e_y + (z_{r_i} - z_{i1})e_z$与$\boldsymbol{u}_i$同向。  

记$s = 0$表示该入射光不形成阴影，$s = 1$表示该入射光线形成阴影，则形成阴影$s = 1$的等价条件为：  
$$
\begin{cases} 
(x_{r_i} - x_{i1})u_{ix} + (y_{r_i} - y_{i1})u_{iy} + (z_{r_i} - z_{i1})u_{iz} > 0 \\
(x_{i1}, y_{i1}, z_{i1}) \in Q_j 
\end{cases} \tag{13}
$$ 
其中判断点是否在矩形内的方法见问题一的建模准备，其他情况$s = 0$。  


同理判断反射光线是否会被遮挡，若$(x_{i2}, y_{i2}, z_{i2})$，且$(x_{i2}, y_{i2}, z_{i2})$在第$i$块定日镜反射光线一侧，则反射光线到达集热器之前被第$j$块定日镜阻挡，称为遮挡。$(x_{i2}, y_{i2}, z_{i2})$在定日反射光线一侧，等价于向量$(x_{2i} - x_{r_i})e_x + (y_{2i} - y_{r_i})e_y + (z_{2i} - z_{r_i})e_z$与$\boldsymbol{v}_i$同向。  

记$b = 0$表示该反射光线不形成遮挡，$b = 1$表示该反射光线形成遮挡，则形成遮挡$b = 1$的等价条件为：  
$$
\begin{cases} 
(x_{2i} - x_{r_i})v_{ix} + (y_{2i} - y_{r_i})v_{iy} + (z_{2i} - z_{r_i})v_{iz} > 0 \\
(x_{2i}, y_{2i}, z_{2i}) \in Q_j 
\end{cases} \tag{14}
$$ 


入射光线形成阴影以及反射光线形成遮挡的示意图如下：  
![[Pasted image 20250629105607.png]]

<div align="center">
    <p>图 4</p>  
</div>  

当$s = 0$且$b = 0$时，表示该入射光线不形成阴影以及反射光线不形成遮挡。记第$i$块定日镜对应$s = 0$且$b = 0$的光线数目为$N_{ti}$，总入射光线为$N_i$，因此每块定日镜年平均阴影遮挡效率$(\eta_{sb})_i$为：  
$$
(\eta_{sb})_i = \frac{N_{ti}}{N_i} \tag{15}
$$ 


#### 截断效率模型  
截断效率定义为吸热器截获的能量占镜场汇聚能量的百分比$^{[2]}$。  

镜面每一点反射光线是构成一束锥形光束，半角展宽为$4.65 \text{mrad}$$^{[2]}$，因此反射光线会在集热器表面上形成光斑。  

第$i$块定日镜的截断效率可以等价于第$i$块定日镜反射且无遮挡光线中，打到集热器上的光线数目$N_{di}$的占比，即：  
$$
(\eta_{\text{trunc}})_i = \frac{N_{di}}{N_i} \tag{16}
$$ 


#### 余弦效率模型  
余弦效率是指定日镜面上入射光线和镜面反射点的法线方向之间夹角$\theta$的余弦值$\cos\theta$$^{[1]}$。第$i$个定日镜的余弦效率$\eta_{\text{cos}}$为：  
$$
(\eta_{\text{cos}})_i = \cos\theta_i = \frac{|\boldsymbol{n}_i \cdot \boldsymbol{v}_i|}{||\boldsymbol{n}_i|| \cdot ||\boldsymbol{v}_i||} \tag{17}
$$ 
其中$\theta_i$是第$i$块定日镜中心的入射光线的方向向量$\boldsymbol{v}_i$与该定日镜法向向量$\boldsymbol{n}_i$所形成的锐角夹角。  


#### 大气透射率模型  
太阳光经由定日镜反射后到达集热器表面的过程中，太阳辐射因大气散射或被空气中的杂质颗粒物阻挡，造成能量损失。大气透射率定义为太阳光线穿过大气到达集热器表面的能量比例$^{[1]}$。第$i$块定日镜对应的大气透射率为：  
$$
(\eta_{\text{at}})_i = 0.99321 - 0.0001176 (d_{HR})_i + 1.97 \times 10^{-8} (d_{HR})_i^2 \quad (d_{HR})_i \leq 1000 \tag{18}
$$ 
### 定日镜场输出热功率模型  

其中$(d_{HR})_i$为第$i$块定日镜中心到集热器中心的距离，其计算公式如下：  
$$
(d_{HR})_i = \sqrt{(x_i - x_c)^2 + (y_i - y_c)^2 + (z_i - z_c)^2} \tag{19}
$$ 


#### 定日镜场输出热功率模型  
将地球上垂直于太阳光线的平面单位面积上，单位时间内接收到的太阳辐射能量定义为法向直接辐射照度$\text{DNI}$$^{[3]}$，可以由以下公式计算得：  
$$
\begin{cases} 
\text{DNI} = G_0 \big[ a + b \cdot exp\big( -\frac{c}{\sin \alpha_s} \big) \big] \\
a = 0.4237 - 0.00821(6 - H_a)^2 \\
b = 0.5055 + 0.00595(6.5 - H_a)^2 \\
c = 0.2711 + 0.01858(2.5 - H_a)^2 
\end{cases} \tag{20}
$$ 
其中$\text{DNI}$为法向直接辐射照度 (单位：$\text{kW/m}^2$)；$a,b,c$为经验公式的系数；$H_a$为当地海拔高度 (单位：$\text{km}$)；$G_0$为太阳常数，其值为$1.366 \text{kW/m}^2$。  


定日镜场的输出热功率$E_{\text{field}}$为：  
$$
E_{\text{field}} = \text{DNI} \cdot \sum_{i=1}^{N} A_i \cdot \eta_i \tag{21}
$$ 
其中$\text{DNI}$为法向直接辐射照度 (单位：$\text{kW/m}^2$)；$N$为定日镜总数 (单位：面)；$A_i$为第$i$面定日镜采光面积 (单位：$\text{m}^2$)；$\eta_i$为第$i$面镜子的光学效率。  


定日镜的光学效率$\eta$的计算公式如下：  
$$
\eta = \eta_{sb} \cdot \eta_{\text{cos}} \cdot \eta_{at} \cdot \eta_{\text{trunc}} \cdot \eta_{\text{ref}} \tag{22}
$$ 
其中$\eta_{sb}$为阴影遮挡效率，$\eta_{\text{cos}}$为余弦效率，$\eta_{at}$为大气投射率，$\eta_{\text{trunc}}$为集热器截断效率，$\eta_{\text{ref}}$为镜面反射率。  


### 定日镜场模型整合与求解  

综上所述，在本问题中建立了定日镜场光学效率与输出热功率求解模型：  

$$
\begin{cases} 
\text{太阳光线入射} & \begin{cases} 
\sin \delta = \sin \frac{2\pi D}{365} \sin \left( \frac{2\pi}{360} 23.45 \right) \\
\omega = \frac{\pi}{12}(ST - 12) \\
\sin \alpha_s = \cos \delta \cos \varphi \cos \omega + \sin \delta \sin \varphi 
\end{cases} \\
\text{阴影判断} & \begin{cases} 
(x_{r_i} - x_{i1})u_{ix} + (y_{r_i} - y_{i1})u_{iy} + (z_{r_i} - z_{i1})u_{iz} > 0 \\
(x_{i1}, y_{i1}, z_{i1}) \in Q_j 
\end{cases} \\
\text{遮挡判断} & \begin{cases} 
(x_{2i} - x_{r_i})v_{ix} + (y_{2i} - y_{r_i})v_{iy} + (z_{2i} - z_{r_i})v_{iz} > 0 \\
(x_{2i}, y_{2i}, z_{2i}) \in Q_j 
\end{cases} \\
\text{镜场效率与热功率计算} & \begin{cases} 
(\eta_{sb})_i = \frac{N_{ti}}{N_i} \\
(\eta_{\text{trunc}})_i = \frac{N_{di}}{N_i} \\
(\eta_{\text{cos}})_i = \cos\theta_i = \frac{|\boldsymbol{n}_i \cdot \boldsymbol{v}_i|}{||\boldsymbol{n}_i|| \cdot ||\boldsymbol{v}_i||} \\
(\eta_{at})_i = 0.99321 - 0.0001176 (d_{HR})_i + 1.97 \times 10^{-8} (d_{HR})_i^2 \\
(\eta_{\text{ref}})_i = 0.92 \\
\eta_i = \eta_{sb} \cdot \eta_{\text{cos}} \cdot \eta_{at} \cdot \eta_{\text{trunc}} \cdot \eta_{\text{ref}} \\
E_{\text{field}} = \text{DNI} \cdot \sum_{i=1}^{N} A_i \cdot \eta_i 
\end{cases} 
\end{cases} \tag{23}
$$ 


#### 5.1.3 问题一的模型求解  
在本问题中，将定日镜反射集热过程划分为太阳光线入射过程、定日镜法向调整过程、阴影遮挡与集热器截断过程。对这三个过程进行仿真模拟，从而得到阴影遮挡效率等需要计算的指标。仿真步骤如算法 1 所述。  


**算法 1：栅格化模拟定日镜反射太阳光的过程仿真**  
- **输入**：待求月份$X$、当地时间$Y$、定日镜以及集热器坐标  
- **输出**：定日镜场每月 21 日的平均光学效率及输出功率  


**Step1**：根据太阳高度角和方位角，以及当地的地理位置，输入日期$X$月 21 日和当地时间$Y$时刻，求解在$X$月 21 日$Y$时刻的太阳光的入射方向，得到$X$月 21 日$Y$时刻的入射光方向向量。  

**Step2**：根据附件的数据和已知数据可以得到定日镜以及集热器的三维坐标，由定日镜和集热器的中心可以求出反射光线的方向向量，入射方向向量和反射方向向量根据菱形几何关系可以求出定日镜法向量。  

**Step3**：开始入射的阴影模拟：对第$i$个定日镜进行分析，将该定日镜分成若干栅格，遍历每个栅格，对每个栅格执行 Step4。  

**Step4**：将栅格中心作为入射光线的接触点 (即入射光在栅格中心)。寻找与第$i$个定日镜最近的其他 6 个定日镜，求出入射光线和这些定日镜所在平面的交点。判断交点是否在这些定日镜框定的矩形内，若交点落入矩形，且矩形被入射光穿透 (入射光不是一条直线，终点在第$i$个定日镜面，背后的矩形不会被穿透，需要排除)，则说明入射光被该栅格阻挡，产生了阴影。若该栅格没有阴影，转入 Step5 判断该栅格的反射光线是否会被遮挡。  

**Step5**：将栅格中心作为反射光线的出发点。与 Step4 类似，寻找反射光线和其他 6 个最近邻定日镜的交点。若交点在矩形内，并被反射光穿透，则说明产生了遮挡。返回 Step3 遍历其他栅格，若遍历完成，记录栅格的阴影遮挡信息，执行 Step6。  

**Step6**：循环执行 Step3 - Step5 直至遍历所有定日镜。遍历完成后执行 Step7 开始模拟截断过程，计算截断效率。  

**Step7**：开始反射的截断效率计算：将反射光线模拟成锥形光线，锥形光线会在集热器上形成光斑。对于第$i$个定日镜，将该定日镜分成若干栅格，根据记录的栅格阴影遮挡信息，得到没有阴影遮挡的栅格所形成的总光斑面积和集热器接收到的光斑面积，从而计算得出第$i$个定日镜的截断效率。遍历所有定日镜得到所有的截断效率。  

**Step8**：根据以上结果计算光学效率及输出功率。遍历其他日期和时刻，得到每月 21 日的平均光学效率及输出功率，从而得到年平均光学效率及输出功率。  


为直观的展示算法流程，上述算法的流程图如下所示：  
![[Pasted image 20250629142039.png]]
<div align="center">
    <p>图 5 算法 1 的流程图</p>  
</div>  


该算法将定日镜的镜面栅格化，以便于对入射和反射光线的模拟。计算截断效率时，由于镜面高度相对于定日镜到集热器中心的距离较小，故计算光斑大小时，忽略定日镜镜面到集热器中心距离变化。  

求出各指标的月平均值，其结果如表 2 所示。此外，通过月平均指标求出定日镜场的年平均光学效率以及输出热功率等指标如表 3 所示。  


#### 表 2 每月 21 日平均光学效率及输出功率（详见附录 A）  
| 日期     | 平均光学效率 | 平均余弦效率 | 平均阴影遮挡效率 | 平均截断效率 | 单位面积镜面平均输出热功率 (kW/m²) |  
| -------- | ------------ | ------------ | ---------------- | ------------ | ---------------------------------- |  
| 1 月 21 日  | 0.4705       | 0.7199       | 0.8967           | 0.8070       | 0.3404                             |  
| 3 月 21 日  | 0.4980       | 0.7611       | 0.9058           | 0.8084       | 0.3955                             |  
| 5 月 21 日  | 0.5038       | 0.7893       | 0.8859           | 0.8086       | 0.4145                             |  
| 7 月 21 日  | 0.5039       | 0.7892       | 0.8862           | 0.8084       | 0.4146                             |  
| 9 月 21 日  | 0.4972       | 0.7601       | 0.9054           | 0.8085       | 0.3942                             |  
| 11 月 21 日 | 0.4682       | 0.7182       | 0.8945           | 0.8068       | 0.3369                             |  


#### 表 3 年平均光学效率及输出功率  
| 年平均光学效率 | 年平均余弦效率 | 年平均阴影遮挡效率 | 年平均截断效率 | 年平均输出热功率 (MW) | 单位面积镜面平均输出热功率 (kW/m²) |  
| -------------- | -------------- | ------------------ | -------------- | --------------------- | ---------------------------------- |  
| 0.4902         | 0.7565         | 0.8955             | 0.8078         | 24.04                 | 0.3827                             |  


### 5.1.4 问题一的模型结果分析  
依据题目信息可得，题中所有指标的计算时刻为一年中每月 21 日 9:00、10:30、12:00、13:30、15:00。通过对记录的时刻进行分析，9:00、10:30 关于中午 12:00 分别与 13:30、15:00 对称。此外一年之中太阳的视运动轨迹也关于定日镜场对称，因此在本题中整个定日镜场的所有的“年平均”指标关于东西方向对称。其中定日镜场的年平均大气透射效率以及年平均截断效率关于镜日场中心对称。镜日场中的每块定日镜的年大气透射效率，年平均截断效率，年平均余弦效率，年平均阴影遮挡效率，年平均光学效率和年平均输出热功率的散点分布示意图如下：  


（文档右下角有 “中国大学生在线 dxs.moe.gov.cn” 标识 ，原文呈现页码 “14”  ）
### 定日镜场效率散点分布  
![[Pasted image 20250629142217.png]]
<div align="center">
    <p>图 6</p>  
</div>  


由于太阳视运动轨迹在东西方向上对称，因此散点图也应大致关于东西方向对称。  
### 5.2 问题二的模型建立与求解
#### 5.2.1 问题二的模型建立
本问题需要在满足定日镜场额定功率、定日镜尺寸、定日镜间距限制的条件下，最优化单位镜面面积年平均输出热功率$P_d$，建立以$P_d$为目标函数的单目标优化模型。  

首先设定日镜总数为$N$，每块定日镜镜面宽度为$W$，高度为$H$，安装高度为$h$，则单位镜面面积年平均输出热功率$P_d$，即优化目标如下。  

**优化目标**：  
$$
P_d = \frac{E_y}{NWH} \tag{24}
$$ 
其中$E_y$为定日镜场年平均输出热功率。  


**约束条件**：  

为确定该模型的约束条件，首先设吸收塔的横纵坐标分别为$x_c$，$y_c$，第$i$块定日镜位置为$(x_i, y_i, h)$。由于吸收塔周围 100m 以内不设置定日镜，故有：  
$$
\forall i \in \{1,2,\dots,N\}, \quad \sqrt{(x_i - x_c)^2 + (y_i - y_c)^2} \geq 100 \tag{25}
$$ 

由于镜面宽度不小于镜面高度，故有：  
$$
W \geq H \tag{26}
$$ 

镜面边长在 2m 到 8m 之间，且定日镜的安装高度在 2m 至 6m 之间，故有：  
$$
W \in [2,8], \quad H \in [2,8], \quad h \in [2,6] \tag{27}
$$ 

定日镜的安装高度必须保证镜面在绕水平转轴旋转时不会触及地面，故有：  
$$
h \geq \frac{1}{2}H \tag{28}
$$ 

为保持清洁，相邻的定日镜底座中心之间的距离比镜面宽度多 5m 以上，故有：  
$$
\forall i,j \in \{1,2,\dots,N\}, \quad \sqrt{(x_i - x_j)^2 + (y_i - y_j)^2} \geq W + 5 \tag{29}
$$ 

此外定日镜均位于半径 350m 的范围内，故有：  
$$
\forall i \in \{1,2,\dots,N\}, \quad \sqrt{x_i^2 + y_i^2} \leq 350 \tag{30}
$$ 

定日镜场的额定年平均输出热功率还需要达到 60MW，故有：  
$$
E_y \geq 60 \times 10^3 \tag{31}
$$ 


综上所述，建立镜场年平均功率单目标优化模型如下：  


（文档右下角有 “中国大学生在线 dxs.moe.gov.cn” 标识 ，原文呈现页码 “16”  ）
### 问题二模型的完整构建与求解
$$
\max \quad P_d \tag{32}
$$

$$
\text { s.t }\begin{cases}
\forall i \in\{1,2, \ldots, N\}, \quad \sqrt{\left(x_i-x_c\right)^2+\left(y_i-y_c\right)^2} \geq 100 \\
W \geq H \\
W \in[2,8], \quad H \in[2,8], \quad h \in[2,6] \\
h \geq \frac{1}{2} H \\
\forall i, j \in\{1,2, \ldots, N\}, \quad \sqrt{\left(x_i-x_j\right)^2+\left(y_i-y_j\right)^2} \geq W+5 \\
\forall i \in\{1,2, \ldots, N\}, \quad \sqrt{x_i^2+y_i^2} \leq 350 \\
E_y \geq 60 \times 10^3
\end{cases} \tag{33}
$$

### 5.2.2 问题二的模型求解
在本问题中，优化目标为单位镜面面积年平均输出热功率$P_d$，其自变量为多维向量，其中包括吸收塔位置坐标、定日镜尺寸、定日镜安装高度、定日镜数目、定日镜位置。因此为优化该目标函数，我们分析其中一个变量时，将其他变量固定，得到每一变量单独对该目标函数的影响。为加快运行速度，经检验，可仅将镜面分为$2\times2$的栅格进行相关指标计算，与上一问题计算结果偏差在$2\%$以内。  

由第一问求解结果所得各个指标的散点图可知，北方的光学效率整体高于南方的光学效率，因此为获得更大的单位镜面面积年平均输出热功率，将吸收塔的位置坐标由定日镜场中心向南方移动。设吸收塔向南方移动的距离为$D$，固定其他变量进行并改变$D$的值，模拟得到不同$D$取值下的目标函数值$P_d$，并证明了$P_d$是关于$D$的单峰函数。（详情见附件代码 m21）  

此后，将定日镜宽度$W$与高度$H$一起进行验证，通过模拟发现在不同$W$和$H$的取值下，当$W = H$时$P_d$有最大值。（详情请见附录代码 m22）同理将定日镜宽度$W$和相邻定日镜间距$dr$一起验证，通过模拟发现在不同$W$和$dr$的取值下，当$dr = W + 5$时$P_d$有最大值。（详情请见附录代码 m22）最后考虑$W$单独为$P_d$的影响，模拟发现$P_d$是关于$W$的单峰函数。（详情请见附录代码 m23）至于定日镜数量以及定日镜位置，在上述调节过程中已经安置好。定日镜高度在本问题只影响截断效率，故取最大值使得截断效率最大。上述分析中我们发现有$P_d(D)$单峰曲线和$P_d(W)$单峰曲线，通过求解曲线的极大值点，即可得到变量的较优解。  

为求解无解析式的单峰函数的极值点，我们将采用三分查找法对其进行求解。三分法是二分法的变种，他最基本的用途是求单峰函数的极值点。  

**算法 2：三分查找算法**  
输入：单峰曲线离散节点与对应函数值，停止条件$\epsilon$为一较小的正数，即代表迭代收敛。  

（文档右下角有 “中国大学生在线 dxs.moe.gov.cn” 标识 ，原文呈现页码 “17”  ）
### 算法 2：三分查找算法（续）
输出：极大值和极大值点  

**Step1**：计算$l_{\text{sec}}$和$r_{\text{sec}}$的目标函数值$f(l_{\text{sec}})$和$f(r_{\text{sec}})$，如果$f(l_{\text{sec}}) < f(r_{\text{sec}})$，转至 Step2；如果$f(l_{\text{sec}}) > f(r_{\text{sec}})$，转至 Step3  

**Step2**：极大值一定在$[l_{\text{sec}}, r]$内取到，令$l = l_{\text{sec}}$，计算更新的$l_{\text{sec}} = l + (r_{\text{sec}} - l_{\text{sec}})/3$和$r_{\text{sec}} = l + 2 \times (r_{\text{sec}} - l_{\text{sec}})/3$。如果$|l_{\text{sec}} - r_{\text{sec}}| < \epsilon$，结束迭代并输出结果。  

**Step3**：极大值一定在$[l, r_{\text{sec}}]$内取到，令$r = r_{\text{sec}}$，计算更新的$l_{\text{sec}} = l + (r_{\text{sec}} - l_{\text{sec}})/3$和$r_{\text{sec}} = l + 2 \times (r_{\text{sec}} - l_{\text{sec}})/3$。如果$|l_{\text{sec}} - r_{\text{sec}}| < \epsilon$，结束迭代并输出结果。  


<div align="center">
    <img src="https://example.com/algorithm-2.png" alt="图 7 算法 2 的图形解释">  
    <p>图 7 算法 2 的图形解释</p>  
</div>  


利用三分法对$P_d$关于$D$的单峰函数和$P_d$关于$W$的单峰函数求解结果示意图如图 9 所示，其中红色点为三分迭代法所寻找的$l_{\text{sec}}$和$r_{\text{sec}}$，蓝色实线为拟合曲线：  


<div align="center">
    <img src="https://example.com/peak-1.png" alt="(a)$P_d(D)$单峰曲线">  
    <p>(a)$P_d(D)$单峰曲线</p>  
    <img src="https://example.com/peak-2.png" alt="(b)$P_d(W)$单峰曲线">  
    <p>(b)$P_d(W)$单峰曲线</p>  
    <p>图 8</p>  
</div>  


由图中数据可得，当吸收塔向南移动距离$D$为 237.0240m，单位镜面面积年平均输  


（文档右下角有 “中国大学生在线 dxs.moe.gov.cn” 标识 ，原文呈现页码 “18”  ）  

说明：因原文未提供实际图的有效链接，此处用 `https://example.com/...` 占位，实际使用时需替换为真实图地址 ，若为本地图，按 Markdown 插入本地图规则调整路径 。
